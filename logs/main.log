INFO:__main__:++++++++++++++++++++++++++++++
INFO:__main__:===== starting run with seed 0 =====
INFO:src.utils:-- loading data from ../processed_data/narrative_trajectories.pkl with test size 0.5 --
INFO:__main__:-- training fqe for evaluation --
INFO:src.model.fqe:-- loaded fqe with run_name seed_0 --
INFO:__main__:-- training narrative planner with original data --
INFO:src.model.bcq:-- loaded behavior cloning with run_name seed_0 --
INFO:src.model.bcq:-- loaded bcq with run_name seed_0 --
INFO:src.model.bcq:epoch: 2/100000 | Q loss:  0.0000 | ecr:  76.2766 | is:  0.0000 | wis:  1.0000 | dr:  153.3529 | dm:  142.5612
INFO:__main__:-- training narrative planner with sim data --
INFO:src.model.bcq:-- loaded behavior cloning with run_name seed_0 --
INFO:src.model.bcq:-- loaded bcq with run_name seed_0 --
INFO:src.model.bcq:epoch: 2/100000 | Q loss:  0.0000 | ecr:  5.5392 | is: -0.0000 | wis:  0.9750 | dr:  147.1513 | dm:  125.1010
INFO:__main__:-- training narrative planner with combined data --
INFO:src.model.bcq:-- loaded behavior cloning with run_name seed_0 --
INFO:src.model.bcq:-- loaded bcq with run_name seed_0 --
INFO:src.model.bcq:epoch: 2/100000 | Q loss:  0.0000 | ecr: -18.3510 | is: -0.0000 | wis:  1.0000 | dr:  150.6893 | dm:  142.0341
INFO:__main__:++++++++++++++++++++++++++++++
INFO:__main__:===== starting run with seed 1 =====
INFO:src.utils:-- loading data from ../processed_data/narrative_trajectories.pkl with test size 0.5 --
INFO:__main__:-- training fqe for evaluation --
INFO:src.model.fqe:-- loaded fqe with run_name seed_1 --
INFO:__main__:-- training narrative planner with original data --
INFO:src.model.bcq:-- loaded behavior cloning with run_name seed_1 --
INFO:src.model.bcq:-- loaded bcq with run_name seed_1 --
INFO:src.model.bcq:epoch: 2/100000 | Q loss:  0.0000 | ecr:  136.6449 | is: -0.0000 | wis:  0.9625 | dr:  138.5900 | dm:  123.1215
INFO:__main__:-- training narrative planner with sim data --
INFO:src.model.bcq:-- loaded behavior cloning with run_name seed_1 --
INFO:src.model.bcq:-- loaded bcq with run_name seed_1 --
INFO:src.model.bcq:epoch: 2/100000 | Q loss:  0.0000 | ecr:  91.2985 | is:  5.9258 | wis:  83.6868 | dr:  143.1241 | dm:  107.7262
INFO:__main__:-- training narrative planner with combined data --
INFO:src.model.bcq:-- loaded behavior cloning with run_name seed_1 --
INFO:src.model.bcq:-- loaded bcq with run_name seed_1 --
INFO:src.model.bcq:epoch: 2/100000 | Q loss:  0.0000 | ecr:  94.7883 | is:  0.0000 | wis:  0.9624 | dr:  136.6739 | dm:  108.9498
INFO:__main__:++++++++++++++++++++++++++++++
INFO:__main__:===== starting run with seed 2 =====
INFO:src.utils:-- loading data from ../processed_data/narrative_trajectories.pkl with test size 0.5 --
INFO:__main__:-- training fqe for evaluation --
INFO:src.model.fqe:-- loaded fqe with run_name seed_2 --
INFO:__main__:-- training narrative planner with original data --
INFO:src.model.bcq:-- loaded behavior cloning with run_name seed_2 --
INFO:src.model.bcq:-- loaded bcq with run_name seed_2 --
INFO:src.model.bcq:epoch: 2/100000 | Q loss:  0.0000 | ecr:  112.2627 | is: -0.0000 | wis:  1.0000 | dr:  132.7052 | dm:  114.2135
INFO:__main__:-- training narrative planner with sim data --
INFO:src.model.bcq:-- loaded behavior cloning with run_name seed_2 --
INFO:src.model.bcq:-- loaded bcq with run_name seed_2 --
INFO:src.model.bcq:epoch: 2/100000 | Q loss:  0.0000 | ecr:  10.8438 | is: -0.0000 | wis:  0.9350 | dr:  128.6301 | dm:  99.7454
INFO:__main__:-- training narrative planner with combined data --
INFO:src.model.bcq:-- loaded behavior cloning with run_name seed_2 --
INFO:src.model.bcq:-- loaded bcq with run_name seed_2 --
INFO:src.model.bcq:epoch: 2/100000 | Q loss:  0.0000 | ecr: -32.9794 | is:  0.0000 | wis:  1.0000 | dr:  128.4534 | dm:  115.7583
INFO:__main__:++++++++++++++++++++++++++++++
INFO:__main__:===== starting run with seed 3 =====
INFO:src.utils:-- loading data from ../processed_data/narrative_trajectories.pkl with test size 0.5 --
INFO:__main__:-- training fqe for evaluation --
INFO:src.model.fqe:-- loaded fqe with run_name seed_3 --
INFO:__main__:-- training narrative planner with original data --
INFO:src.model.bcq:-- loaded behavior cloning with run_name seed_3 --
INFO:src.model.bcq:-- loaded bcq with run_name seed_3 --
INFO:src.model.bcq:epoch: 2/100000 | Q loss:  0.0000 | ecr:  30.0281 | is: -0.0220 | wis: -95.1290 | dr:  154.9769 | dm:  133.8528
INFO:src.utils:-- loading data from ../processed_data/student_trajectories.pkl with test size 0.2 --
INFO:src.model.validator:loaded validator with run_name seed_3
INFO:src.model.gail:args: {
  "seed": 3,
  "run_name": "seed_3",
  "gail_train_steps": 1000,
  "dryrun": false,
  "load_validator": false,
  "load_gail": false,
  "load_sim": true,
  "debug": false,
  "load_fqe": true,
  "load_bc": false,
  "state_dim": 27,
  "action_dim": 19,
  "is_random_planner": true,
  "student_data_loc": "../processed_data/student_trajectories.pkl",
  "narrative_data_loc": "../processed_data/narrative_trajectories.pkl",
  "device": "cpu",
  "units": 128,
  "lr_actor": 0.001,
  "lr_critic": 0.001,
  "lr_discriminator": 0.001,
  "scheduler_gamma": 0.99,
  "internal_epoch_pi": 20,
  "internal_epoch_d": 2,
  "discount_factor": 0.99,
  "clip_eps": 0.1,
  "max_episode_len": 1000,
  "update_steps": 1000,
  "simulate_episodes": 1000,
  "lr_validator": 0.001,
  "validator_train_steps": 1000,
  "validator_batch": 1000,
  "validator_auth_threshold": 0.95,
  "bcq_batch": 1000,
  "lr_bcq": 0.001,
  "bcq_threshold": 0.1,
  "bcq_train_steps": 100000,
  "bcq_update_frequency": 1000,
  "behavior_cloning_train_steps": 100000,
  "bc_batch": 1000,
  "fqe_train_steps": 100000,
  "lr_fqe": 0.001,
  "fqe_update_frequency": 1000,
  "fqe_batch": 1000,
  "np_state_dim": 31,
  "np_action_dim": 10,
  "np_discount": 0.99
}
INFO:src.model.crystalisland:finished creating random samples
INFO:src.model.gail:-- loaded gail with run_name seed_3 and name org--
INFO:src.model.gail:creating simulated data
INFO:__main__:-- training narrative planner with sim data --
INFO:src.model.bcq:-- no behavior cloning with run_name seed_3 --
INFO:src.model.bcq:-- training bcq behavior cloning --
INFO:src.model.bcq:training behavior cloning | step 1000 or 100000 | loss  0.0383
INFO:src.model.bcq:training behavior cloning | step 2000 or 100000 | loss  0.0272
INFO:src.model.bcq:training behavior cloning | step 3000 or 100000 | loss  0.0294
INFO:src.model.bcq:training behavior cloning | step 4000 or 100000 | loss  0.0213
INFO:src.model.bcq:training behavior cloning | step 5000 or 100000 | loss  0.0226
INFO:src.model.bcq:training behavior cloning | step 6000 or 100000 | loss  0.0247
INFO:src.model.bcq:training behavior cloning | step 7000 or 100000 | loss  0.0454
INFO:src.model.bcq:training behavior cloning | step 8000 or 100000 | loss  0.0442
INFO:src.model.bcq:training behavior cloning | step 9000 or 100000 | loss  0.0424
INFO:src.model.bcq:training behavior cloning | step 10000 or 100000 | loss  0.0440
INFO:src.model.bcq:training behavior cloning | step 11000 or 100000 | loss  0.0230
INFO:src.model.bcq:training behavior cloning | step 12000 or 100000 | loss  0.0206
INFO:src.model.bcq:training behavior cloning | step 13000 or 100000 | loss  0.0167
INFO:src.model.bcq:training behavior cloning | step 14000 or 100000 | loss  0.0197
INFO:src.model.bcq:training behavior cloning | step 15000 or 100000 | loss  0.0197
INFO:src.model.bcq:training behavior cloning | step 16000 or 100000 | loss  0.0188
INFO:src.model.bcq:training behavior cloning | step 17000 or 100000 | loss  0.0191
INFO:src.model.bcq:training behavior cloning | step 18000 or 100000 | loss  0.0241
INFO:src.model.bcq:training behavior cloning | step 19000 or 100000 | loss  0.0229
INFO:src.model.bcq:training behavior cloning | step 20000 or 100000 | loss  0.0218
INFO:src.model.bcq:training behavior cloning | step 21000 or 100000 | loss  0.0201
INFO:src.model.bcq:training behavior cloning | step 22000 or 100000 | loss  0.0194
INFO:src.model.bcq:training behavior cloning | step 23000 or 100000 | loss  0.0216
INFO:src.model.bcq:training behavior cloning | step 24000 or 100000 | loss  0.0176
INFO:src.model.bcq:training behavior cloning | step 25000 or 100000 | loss  0.0293
INFO:src.model.bcq:training behavior cloning | step 26000 or 100000 | loss  0.0263
INFO:src.model.bcq:training behavior cloning | step 27000 or 100000 | loss  0.0244
INFO:src.model.bcq:training behavior cloning | step 28000 or 100000 | loss  0.0254
INFO:src.model.bcq:training behavior cloning | step 29000 or 100000 | loss  0.0237
INFO:src.model.bcq:training behavior cloning | step 30000 or 100000 | loss  0.0244
INFO:src.model.bcq:training behavior cloning | step 31000 or 100000 | loss  0.0255
INFO:src.model.bcq:training behavior cloning | step 32000 or 100000 | loss  0.1323
INFO:src.model.bcq:training behavior cloning | step 33000 or 100000 | loss  0.1299
INFO:src.model.bcq:training behavior cloning | step 34000 or 100000 | loss  0.1280
INFO:src.model.bcq:training behavior cloning | step 35000 or 100000 | loss  0.1242
INFO:src.model.bcq:training behavior cloning | step 36000 or 100000 | loss  0.1284
INFO:src.model.bcq:training behavior cloning | step 37000 or 100000 | loss  0.1321
INFO:src.model.bcq:training behavior cloning | step 38000 or 100000 | loss  0.1321
INFO:src.model.bcq:training behavior cloning | step 39000 or 100000 | loss  0.1325
INFO:src.model.bcq:training behavior cloning | step 40000 or 100000 | loss  0.1310
INFO:src.model.bcq:training behavior cloning | step 41000 or 100000 | loss  0.1258
INFO:src.model.bcq:training behavior cloning | step 42000 or 100000 | loss  0.1297
INFO:src.model.bcq:training behavior cloning | step 43000 or 100000 | loss  0.1266
INFO:src.model.bcq:training behavior cloning | step 44000 or 100000 | loss  0.1339
INFO:src.model.bcq:training behavior cloning | step 45000 or 100000 | loss  0.1323
INFO:src.model.bcq:training behavior cloning | step 46000 or 100000 | loss  0.1318
INFO:src.model.bcq:training behavior cloning | step 47000 or 100000 | loss  0.1296
INFO:src.model.bcq:training behavior cloning | step 48000 or 100000 | loss  0.1304
INFO:src.model.bcq:training behavior cloning | step 49000 or 100000 | loss  0.1266
INFO:src.model.bcq:training behavior cloning | step 50000 or 100000 | loss  0.1265
INFO:src.model.bcq:training behavior cloning | step 51000 or 100000 | loss  0.1301
INFO:src.model.bcq:training behavior cloning | step 52000 or 100000 | loss  0.1279
INFO:src.model.bcq:training behavior cloning | step 53000 or 100000 | loss  0.1290
INFO:src.model.bcq:training behavior cloning | step 54000 or 100000 | loss  0.1270
INFO:src.model.bcq:training behavior cloning | step 55000 or 100000 | loss  0.1304
INFO:src.model.bcq:training behavior cloning | step 56000 or 100000 | loss  0.1302
INFO:src.model.bcq:training behavior cloning | step 57000 or 100000 | loss  0.1321
INFO:src.model.bcq:training behavior cloning | step 58000 or 100000 | loss  0.1297
INFO:src.model.bcq:training behavior cloning | step 59000 or 100000 | loss  0.1297
INFO:src.model.bcq:training behavior cloning | step 60000 or 100000 | loss  0.1287
INFO:src.model.bcq:training behavior cloning | step 61000 or 100000 | loss  0.1273
INFO:src.model.bcq:training behavior cloning | step 62000 or 100000 | loss  0.1259
INFO:src.model.bcq:training behavior cloning | step 63000 or 100000 | loss  0.1336
INFO:src.model.bcq:training behavior cloning | step 64000 or 100000 | loss  0.1351
INFO:src.model.bcq:training behavior cloning | step 65000 or 100000 | loss  0.1287
INFO:src.model.bcq:training behavior cloning | step 66000 or 100000 | loss  0.1322
INFO:src.model.bcq:training behavior cloning | step 67000 or 100000 | loss  0.1316
INFO:src.model.bcq:training behavior cloning | step 68000 or 100000 | loss  0.1247
INFO:src.model.bcq:training behavior cloning | step 69000 or 100000 | loss  0.1335
INFO:src.model.bcq:training behavior cloning | step 70000 or 100000 | loss  0.1294
INFO:src.model.bcq:training behavior cloning | step 71000 or 100000 | loss  0.1289
INFO:src.model.bcq:training behavior cloning | step 72000 or 100000 | loss  0.1320
INFO:src.model.bcq:training behavior cloning | step 73000 or 100000 | loss  0.1322
INFO:src.model.bcq:training behavior cloning | step 74000 or 100000 | loss  0.1289
INFO:src.model.bcq:training behavior cloning | step 75000 or 100000 | loss  0.1289
INFO:src.model.bcq:training behavior cloning | step 76000 or 100000 | loss  0.1296
INFO:src.model.bcq:training behavior cloning | step 77000 or 100000 | loss  0.1294
INFO:src.model.bcq:training behavior cloning | step 78000 or 100000 | loss  0.1323
INFO:src.model.bcq:training behavior cloning | step 79000 or 100000 | loss  0.1300
INFO:src.model.bcq:training behavior cloning | step 80000 or 100000 | loss  0.1278
INFO:src.model.bcq:training behavior cloning | step 81000 or 100000 | loss  0.1288
INFO:src.model.bcq:training behavior cloning | step 82000 or 100000 | loss  0.1343
INFO:src.model.bcq:training behavior cloning | step 83000 or 100000 | loss  0.1276
INFO:src.model.bcq:training behavior cloning | step 84000 or 100000 | loss  0.1320
INFO:src.model.bcq:training behavior cloning | step 85000 or 100000 | loss  0.1271
INFO:src.model.bcq:training behavior cloning | step 86000 or 100000 | loss  0.1291
INFO:src.model.bcq:training behavior cloning | step 87000 or 100000 | loss  0.1320
INFO:src.model.bcq:training behavior cloning | step 88000 or 100000 | loss  0.1292
INFO:src.model.bcq:training behavior cloning | step 89000 or 100000 | loss  0.1351
INFO:src.model.bcq:training behavior cloning | step 90000 or 100000 | loss  0.1303
INFO:src.model.bcq:training behavior cloning | step 91000 or 100000 | loss  0.1284
INFO:src.model.bcq:training behavior cloning | step 92000 or 100000 | loss  0.1276
INFO:src.model.bcq:training behavior cloning | step 93000 or 100000 | loss  0.1292
INFO:src.model.bcq:training behavior cloning | step 94000 or 100000 | loss  0.1304
INFO:src.model.bcq:training behavior cloning | step 95000 or 100000 | loss  0.1360
INFO:src.model.bcq:training behavior cloning | step 96000 or 100000 | loss  0.1320
INFO:src.model.bcq:training behavior cloning | step 97000 or 100000 | loss  0.1350
INFO:src.model.bcq:training behavior cloning | step 98000 or 100000 | loss  0.1292
INFO:src.model.bcq:training behavior cloning | step 99000 or 100000 | loss  0.1330
INFO:src.model.bcq:training behavior cloning | step 100000 or 100000 | loss  0.1257
INFO:src.model.bcq:--finished training behavior cloning--
INFO:src.model.bcq:-- saved behavior cloning with run_name seed_3 --
INFO:src.model.bcq:-- no bcq with run_name seed_3 --
INFO:src.model.bcq:-- training bcq --
INFO:src.model.bcq:epoch: 1000/100000 | Q loss:  171.5950 | ecr:  0.4456 | is: -0.0000 | wis:  0.9875 | dr:  150.0325 | dm:  93.2326
Traceback (most recent call last):
  File "/Users/fahmid/IntelliMedia/CrystalIsland RL/src/main.py", line 103, in <module>
    full_run()
  File "/Users/fahmid/IntelliMedia/CrystalIsland RL/src/main.py", line 80, in full_run
    bcq_sim.train()
  File "/Users/fahmid/IntelliMedia/CrystalIsland RL/src/model/bcq.py", line 95, in train
    q1 = self.Q(next_state)
  File "/Users/fahmid/opt/anaconda3/envs/deeprl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/Users/fahmid/IntelliMedia/CrystalIsland RL/src/model/nets.py", line 82, in forward
    q = torch.tanh(self.q1(state))
KeyboardInterrupt
